@model ReflectionIT.Mvc.Paging.PagingList<RentHouse.Models.ApplicationUser>
@using ReflectionIT.Mvc.Paging
@addTagHelper *, ReflectionIT.Mvc.Paging.PagingList
@{
	ViewData["Title"] = "User";
	Layout = "~/Areas/Admins/Views/Shared/_Layout.cshtml";
}
@{
    var start = this.Model.StartPageIndex;
    var stop = this.Model.StopPageIndex;
}
<p>
    <a asp-action="CreateUser">Create New</a>
</p>
                <form class="form-inline"  role="form">
                        <div class="form-group input ">
                        <input style="border:none;box-shadow: none !important;background-color: #DDDDDD;" type="text" class="form-control" name="" id="search" placeholder="Nhập" value="@ViewBag.keyworduser">   
                        </div>
                        <button type="button" id="searchurl" class="iconsearch"><i class="fas fa-search" aria-hidden="true" style="color: white;width:80px;height:40px;"></i>
                        </button>
                </form>
                
<table class="table">
    <thead>
        <tr>
          
            <th>
                @Html.DisplayNameFor(model => model.First().UserName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.First().FirtsName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.First().Email)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.First().City)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.First().District)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.First().LockoutEnabled)
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
    {
        ViewData["isdeleted"]= !@item.LockoutEnabled ? "opacity:0.7" : ""; 
    }
            <tr  style="@ViewData["isdeleted"];">
            <td>
                @Html.DisplayFor(modelItem => item.UserName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.FirtsName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Email)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.City)
            </td>           
            <td>
                @Html.DisplayFor(modelItem => item.District)
            </td> 
             @if(!item.LockoutEnabled){
                   <td>Đã Khóa</td>
                }else{
                    <td>Chưa Khóa</td> 
             }
            <td>
                <a asp-action="EditUser" asp-route-id="@item.Id">Edit</a> |
                @if(!item.LockoutEnabled){
                    <button class="btn btn-danger btn-sm rounded-0" type="button"  data-toggle="modal" data-target="#exampleModalCenter" value="@item.Id" >LockoutEnabled</button>
                }else{
                    <button class="btn btn-success btn-sm rounded-0" type="button"  data-toggle="modal" data-target="#exampleModalCenter" value="@item.Id" >UnLockoutEnabled</button>
                }
               
            </td>
        </tr>

                       <div id="exampleModalCenter" class="modal fade">
                                    <div class="modal-dialog modal-confirm">
                                        <div class="modal-content">
                                            <div class="modal-header flex-column">
                                                <h4 class="modal-title w-100">Are you sure?</h4>
                                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                            </div>
                                            <div class="modal-body">
                                                <p>Do you really want to delete these records? This process cannot be undone.</p>
                                            </div>
                                            <div class="modal-footer justify-content-center">
                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                                <form asp-action="DeleteUser">

                                                    <input type="hidden" id="idremove" name="Id" value="" />
                                                     
                                                    <input type="submit" value="Sure"  class="btn btn-danger" />
                                                      
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                         </div>
                         }
    </tbody>
</table>

@if (this.Model.PageCount > 1) {
    <ul class="pagination pagination-sm justify-content-end">

        @if (start > 1) {
            <li class="page-item">
                <a href="@Url.Action(Model.Action, Model.GetRouteValueForPage(1))" aria-label="First" class="page-link">
                    <span aria-hidden="true">1</span>
                </a>
            </li>
        }

        @if (this.Model.PageIndex > 1) {
            <li class="page-item">
                <a href="@Url.Action(Model.Action, Model.GetRouteValueForPage(this.Model.PageIndex - 1))" aria-label="Previous" class="page-link">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
        }

        @for (int i = start; i <= stop; i++) {
            <li class="page-item @((Model.PageIndex == i) ? "active" : null)">
                @Html.ActionLink(i.ToString(), Model.Action,new{inputuser=@ViewBag.keyworduser,pageIndex=i},new { @class = "page-link" })
            </li>
        }

        @if (this.Model.PageIndex < this.Model.PageCount) {
            <li class="page-item">
                <a href="@Url.Action(Model.Action, Model.GetRouteValueForPage(this.Model.PageIndex + 1))" aria-label="Next" class="page-link">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        }

        @if (stop < this.Model.PageCount) {
            <li class="page-item">
                <a href="@Url.Action(Model.Action, Model.GetRouteValueForPage(this.Model.PageCount))" aria-label="Last" class="page-link">
                    <span aria-hidden="true">@this.Model.PageCount</span>
                </a>
            </li>
        }

    </ul>
}
@section Scripts{
    <script>
        $("button").click(function() {
        var id_remove = $(this).attr('value');
            console.log(id_remove);
               $("#idremove").attr("value", id_remove );
        });
        $("#searchurl").click(function (){
            var url = 'Admins/User/?inputuser=' + $("#search").val();
            var urlMain = window.location.href; 
            var arr = urlMain.split("/"); 
            var result = arr[0] + "//" + arr[2] + "/" + url;
            window.location.href = result;
        });
    </script>
}